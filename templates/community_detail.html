{% extends "base.html" %} {% block title %}{{ detail.community.name }} -
Community - Charlie{% endblock %} {% block content %}
<div class="community-detail-page">
    <header class="page-header">
        <nav class="breadcrumb">
            <a href="/">Home</a> → <a href="/communities">Communities</a> →
            <span>{{ detail.community.name }}</span>
        </nav>
    </header>

    <article class="community-content">
        <h1 class="community-name">{{ detail.community.name }}</h1>

        {% if detail.community.summary %}
        <p class="community-summary">{{ detail.community.summary }}</p>
        {% else %}
        <p class="community-summary muted">
            No summary available for this community.
        </p>
        {% endif %}

        <div class="community-stats">
            <span class="stat-item">
                <strong>{{ detail.member_count }}</strong> member{{ 's' if
                detail.member_count != 1 else '' }}
            </span>
            <span class="stat-item">
                <strong>{{ episode_count }}</strong> episode{{ 's' if
                episode_count != 1 else '' }}
            </span>
        </div>

        <section class="community-section">
            <h2>Member Entities</h2>
            {% if detail.members %}
            <ul class="member-list">
                {% for member in detail.members %}
                <li class="member-item">
                    <div class="member-info">
                        <h3 class="member-name">
                            <a href="/entities/{{ member.entity.uuid }}">
                                {{ member.entity.name }}
                            </a>
                        </h3>
                        {% if member.entity.summary %}
                        <p class="member-summary">
                            {{ member.entity.summary }}
                        </p>
                        {% endif %}
                        <p class="member-meta">
                            Mentioned in
                            <strong>{{ member.episode_count }}</strong>
                            episode{{ 's' if member.episode_count != 1 else ''
                            }}
                        </p>
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <p class="empty-message">No member entities found.</p>
            {% endif %}
        </section>

        {% if episodes %}
        <section class="community-section">
            <h2>Related Episodes</h2>
            <p class="section-description">
                Journal entries that mention entities from this community
            </p>
            <div class="episodes-list">
                {% for ep_with_count in episodes %}
                <article class="episode-card">
                    <h3 class="episode-title">
                        <a href="/episodes/{{ ep_with_count.episode.uuid }}">
                            {{ ep_with_count.episode.title }}
                        </a>
                    </h3>
                    <time
                        class="episode-date"
                        datetime="{{ ep_with_count.episode.valid_at.isoformat() }}"
                    >
                        {{ ep_with_count.episode.display_date }}
                    </time>
                    <p class="episode-preview">
                        {{ ep_with_count.episode.preview }}
                    </p>
                    <p class="episode-meta">
                        Mentions
                        <strong
                            >{{ ep_with_count.entity_mention_count }}</strong
                        >
                        entit{{ 'ies' if ep_with_count.entity_mention_count != 1
                        else 'y' }} from this community
                    </p>
                </article>
                {% endfor %}
            </div>
        </section>
        {% else %}
        <section class="community-section">
            <h2>Related Episodes</h2>
            <p class="empty-message">
                No episodes found mentioning this community's entities.
            </p>
        </section>
        {% endif %}

        <footer class="community-footer">
            <a href="/communities" class="button-link">← Back to Communities</a>
        </footer>
    </article>
</div>
{% endblock %}
